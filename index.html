<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Insurer Insights</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Reset & Base Styles --- */
        :root {
            --primary-color: #005f73;
            --secondary-color: #008c9e;
            --dark-text: #212529;
            --light-text: #6c757d;
            --background-color: #f8f9fa;
            --container-bg: #ffffff;
            --border-color: #dee2e6;
            --highlight-bg: #eef7ff;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--dark-text);
        }

        /* --- Navigation Bar --- */
        nav {
            background-color: var(--container-bg);
            padding: 0 5%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }
        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }
        nav ul li a {
            display: block;
            padding: 20px 15px;
            text-decoration: none;
            color: var(--dark-text);
            font-weight: 600;
            transition: color 0.3s ease;
        }
        nav ul li a:hover {
            color: var(--primary-color);
        }

        /* --- Hero Section (Homepage) --- */
        .hero {
            height: 70vh;
            min-height: 400px;
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 0 20px;
        }
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .hero p {
            font-size: 1.5rem;
            max-width: 700px;
            margin-bottom: 30px;
            color: rgba(255,255,255,0.9);
        }
        .hero-button {
            background-color: var(--secondary-color);
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        .hero-button:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }

        /* --- Layout & Container --- */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
            padding: 40px;
            background-color: var(--container-bg);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.05);
        }

        /* --- Section & Typography --- */
        section {
            margin-bottom: 50px;
            padding-top: 60px; /* For nav anchor offset */
            margin-top: -60px; /* For nav anchor offset */
        }
        h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
            font-weight: 600;
        }
        h3 {
             color: var(--dark-text);
             font-size: 1.4rem;
             margin-bottom: 20px;
        }
        p {
            font-size: 1.1rem;
            color: var(--dark-text);
        }

        /* --- Interactive Filters --- */
        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #fdfdff;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        label {
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            font-size: 1.1em;
            color: var(--primary-color);
        }
        select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            background-color: #fff;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236c757d%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 0.65em auto;
            cursor: pointer;
        }

        /* --- Results & Lists --- */
        #results-container {
            margin-top: 20px;
            padding: 25px;
            background-color: var(--highlight-bg);
            border-radius: 8px;
            border: 1px solid #cce7ff;
        }
        #results-container h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.4rem;
        }
        .results-header, .summary-header {
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            color: var(--dark-text);
            padding: 0 20px 10px 45px;
            border-bottom: 2px solid var(--border-color);
        }
        .summary-header {
             padding-left: 20px;
        }
        .results-header .header-group, .summary-header .header-name {
            flex-grow: 1;
        }
        .results-header .header-premium, .results-header .header-share,
        .summary-header .header-premium, .summary-header .header-share {
            text-align: right;
            width: 140px;
        }
        ol {
            list-style-type: none;
            padding-left: 0;
            counter-reset: item;
        }
        ol li {
            background-color: var(--container-bg);
            margin-bottom: 12px;
            padding: 15px 20px;
            border: 1px solid var(--border-color);
            font-size: 1.1em;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        ol li::before {
            content: counter(item) ".";
            counter-increment: item;
            margin-right: 15px;
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.2em;
        }
        .summary-list li::before {
            content: '';
            margin-right: 0;
        }
        .group-name, .summary-name {
            flex-grow: 1;
        }
        .premium-value, .share-value {
            text-align: right;
            width: 140px;
            font-weight: 600;
        }
        .share-value {
             color: var(--secondary-color);
        }

        /* --- Cross-Tab Table --- */
        .crosstab-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .crosstab-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            white-space: nowrap;
        }
        .crosstab-table th, .crosstab-table td {
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            text-align: right;
        }
        .crosstab-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        .crosstab-table td:first-child, .crosstab-table th:first-child {
            text-align: left;
            font-weight: 700;
            position: sticky;
            left: 0;
            background-color: #f8f9fa;
        }
        
        /* --- Company Groups Section --- */
        .group-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .group-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }
        .group-card h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .group-card ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .group-card ul li {
            padding: 5px 0;
            border-bottom: 1px solid #f1f1f1;
        }

        /* --- Footer --- */
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--light-text);
        }

        /* --- INTACT REPORT STYLES --- */
        #intact-report {
            background-color: #F0F2F5;
            color: #333333;
            border-radius: 12px;
            padding: 40px;
            margin-top: 40px;
        }
        #intact-report .intact-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        #intact-report .intact-main {
            display: flex;
            flex-direction: column;
            gap: 6rem;
        }
        #intact-report .intact-section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        #intact-report .intact-section-heading {
            border-bottom: 2px solid #D9DDE1;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        #intact-report .intact-section-heading h2 {
            color: #0A3A67;
            font-size: 2.5rem;
            font-weight: 700;
            border: none;
            padding: 0;
            margin: 0;
        }
        #intact-report .kpi-card {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 1px solid #D9DDE1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        #intact-report .kpi-card .kpi-value {
            color: #0A3A67;
            font-weight: 700;
            font-size: 3.5rem;
        }
        #intact-report .kpi-card .kpi-label {
            color: #555;
            font-weight: 600;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        #intact-report .prose {
            color: #333333;
            max-width: 100%;
        }
        #intact-report .prose h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #0A3A67;
            border-bottom: 1px solid #D9DDE1;
            padding-bottom: 0.5rem;
        }
        #intact-report .prose p { line-height: 1.7; margin-bottom: 1rem; }
        #intact-report .prose ul { list-style-position: outside; padding-left: 1rem; margin-bottom: 1rem; }
        #intact-report .prose li { padding-left: 0.5rem; margin-bottom: 0.75rem; background: none; border: none; }
        #intact-report .prose b { color: #0A3A67; }
        #intact-report .chart-card {
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #D9DDE1;
        }
        #intact-report .chart-container { position: relative; width: 100%; height: 320px; }
        @media (min-width: 768px) { #intact-report .chart-container { height: 400px; } }
        #intact-report table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.03);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        #intact-report th, #intact-report td { text-align: left; padding: 1rem 1.25rem; border-bottom: 1px solid #D9DDE1; }
        #intact-report thead th { background-color: #F0F2F5; font-weight: 600; color: #0A3A67; }
        #intact-report tbody tr:nth-child(even) { background-color: #FAFAFB; }
        #intact-report .swot-card {
            background-color: white; border-radius: 0.5rem; padding: 1.5rem;
            border: 1px solid #D9DDE1; border-left-width: 5px;
        }
        #intact-report .recommendation-card {
            background-color: #FFFFFF; border-radius: 0.5rem; padding: 1.5rem;
            border: 1px solid #D9DDE1; transition: all 0.2s ease-in-out;
        }
        #intact-report .recommendation-card:hover {
             box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
             border-left: 4px solid #008080;
        }
        
        /* --- Mobile Responsiveness --- */
        @media (max-width: 768px) {
            .container { width: 95%; padding: 20px; }
            .hero h1 { font-size: 2.5rem; }
            .hero p { font-size: 1.2rem; }
            .filters { grid-template-columns: 1fr; }
            .results-header, .summary-header { padding: 0 10px 10px 10px; font-size: 0.9em; }
            .results-header .header-premium, .results-header .header-share,
            .summary-header .header-premium, .summary-header .header-share { width: 90px; }
            ol li::before { display: none; }
            ol li { flex-wrap: wrap; }
            .group-name, .summary-name { width: 100%; margin-bottom: 5px; }
            .premium-value, .share-value { width: 50%; text-align: left; font-size: 1em; }
            #intact-report { padding: 20px; }
            #intact-report .intact-section-heading h2 { font-size: 2rem; }
            #intact-report .kpi-card .kpi-value { font-size: 2.5rem; }
        }
    </style>
</head>
<body>
    <nav>
        <a href="#home" class="logo">Industry Insights</a>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#data-explorer">Data Explorer</a></li>
            <li><a href="#market-overview">Market Overview</a></li>
            <li><a href="#company-groups">Company Groups</a></li>
            <li><a href="#intact-report">Company Deep-Dive</a></li>
        </ul>
    </nav>

    <section id="home" class="hero">
        <h1>Clarity in a Complex Market</h1>
        <p>Your data-driven guide to the Canadian Property & Casualty insurance market. We provide clear analysis of market share, industry trends, and the key players shaping the future of insurance.</p>
        <a href="#data-explorer" class="hero-button">Explore the Data</a>
    </section>

    <div class="container">
        <section id="data-explorer">
            <h2>Explore Market Share by Product and Province</h2>
            <p>Select a line of business and a province to see the top 5 insurance groups by market share in 2023.</p>
            <div class="filters">
                <div>
                    <label for="lob-select">Select a Product:</label>
                    <select id="lob-select"></select>
                </div>
                <div>
                    <label for="province-select">Select a Province:</label>
                    <select id="province-select"></select>
                </div>
            </div>
            <div id="results-container"></div>
        </section>

        <section id="market-overview">
            <h2>Canadian Market Overview (2023)</h2>
            <div id="national-summary"></div>
            <div id="provincial-summary" style="margin-top: 40px;"></div>
            <div id="lob-summary" style="margin-top: 40px;"></div>
            <div id="crosstab-summary" style="margin-top: 40px;"></div>
        </section>
        
        <section id="company-groups">
            <h2>Company Groups Explained</h2>
            <p>Market share is often consolidated under parent groups. This table shows which individual companies are included in the major groups for our analysis.</p>
            <div id="group-details"></div>
        </section>

        <!-- INTACT REPORT SECTION START -->
        <section id="intact-report">
            <div class="intact-container">
                <header class="text-center pt-12 pb-20">
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight" style="color: #0A3A67;">Competitive Intelligence Report:<br>Intact Financial Corporation</h1>
                    <p class="text-xl text-gray-600 mt-6 max-w-4xl mx-auto">An exhaustive analysis of strategy, performance, and vulnerabilities from 2019 to 2025, revealing key opportunities for competitors.</p>
                </header>
                <main class="intact-main">
                    <section id="summary" class="intact-section bg-white p-8 md:p-12 rounded-lg border border-D9DDE1">
                        <div class="intact-section-heading">
                            <h2>Executive Summary</h2>
                        </div>
                        <div class="prose max-w-full">
                            <p>This report provides an exhaustive competitive intelligence analysis of Intact Financial Corporation (IFC) for the period spanning 2019 to Q1 2025. IFC has successfully executed a multi-year strategy to transform itself from a dominant Canadian Property & Casualty (P&C) insurer into a diversified international financial services firm with significant operations in the United States and the United Kingdom & Ireland. This evolution has been driven by two primary engines: a highly disciplined and opportunistic M&A strategy, and a relentless focus on operational outperformance.</p>
                            <p>The company's performance is anchored to clear, ambitious financial objectives: achieving 10% annual growth in Net Operating Income Per Share (NOIPS) and consistently outperforming the industry's Return on Equity (ROE) by over 500 basis points. Analysis shows that despite significant underwriting volatility, IFC has largely met these goals. This resilience stems from a deliberate strategy to build powerful, non-underwriting income streams. Rapidly growing net investment income, bolstered by a larger asset base and rising yields, and high-margin distribution income from its brokerage and claims service subsidiaries, now provide a formidable buffer against the inherent unpredictability of catastrophe losses.</p>
                            <p>IFC's core competitive advantages are its unmatched scale in Canada, a proven M&A execution engine, diversified earnings power, and a deeply ingrained culture of discipline. However, this fortress is not without its vulnerabilities. The firm's earnings are subject to significant quarterly volatility from catastrophe losses, the UK&I transformation carries immense execution risk, and it faces persistent competitive pressure in the large-account commercial market.</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 pt-8">
                            <div class="kpi-card">
                                <p class="text-6xl kpi-value">125%</p>
                                <h3 class="text-lg mt-2 kpi-label">Total Premium Growth</h3>
                                <p class="mt-1 text-gray-500 text-sm">(2019 to 2024)</p>
                            </div>
                            <div class="kpi-card">
                                <p class="text-6xl kpi-value">15.2%</p>
                                <h3 class="text-lg mt-2 kpi-label">Avg. Operating ROE</h3>
                                <p class="mt-1 text-gray-500 text-sm">(2019 - 2024 Average)</p>
                            </div>
                            <div class="kpi-card">
                                <p class="text-6xl kpi-value">$2.8B</p>
                                <h3 class="text-lg mt-2 kpi-label">Total Capital Margin</h3>
                                <p class="mt-1 text-gray-500 text-sm">(As of Q2 2025)</p>
                            </div>
                        </div>
                    </section>
                    <section id="strategy-intact" class="intact-section">
                        <div class="intact-section-heading">
                            <h2>I. Corporate Strategy & Performance</h2>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                            <div class="prose max-w-none">
                                <h4>1.1 The North Star: Stated Strategic Objectives</h4>
                                <p>IFC's corporate strategy is anchored by two unwavering, publicly stated financial goals. The first is to grow <b>Net Operating Income Per Share (NOIPS) by 10% annually</b> over time. The second objective is to <b>outperform the industry Return on Equity (ROE) by 500 basis points</b> or more, a direct challenge to its peers and a declaration of its intent to achieve superior capital efficiency.</p>
                                <h4>1.2 Consolidated Performance Against a Volatile Backdrop</h4>
                                <p>The company's scale has expanded dramatically, with annual DPW growing from ~$11B in 2019 to over $23.7B by 2024, largely driven by the 2021 RSA acquisition. While underwriting profitability fluctuates due to CAT losses, NOIPS has shown impressive growth, rising from $5.08 in 2019 to $14.43 in 2024, showcasing the success of its diversified earnings model.</p>
                                <h4>1.3 The Decoupling of Volatility from Earnings</h4>
                                <p>A critical strategic success is the progressive decoupling of earnings growth from underwriting volatility. The primary stabilizer is the firm's large and growing <b>Operating Net Investment Income</b>, now exceeding a $1.5B annual run-rate. The second is <b>Distribution Income</b> from BrokerLink and On Side Restoration, which grew to $524M in 2024. These non-correlated income streams buffer the bottom line against unpredictable insurance results.</p>
                            </div>
                            <div class="chart-card">
                                <div class="chart-container">
                                    <canvas id="dpwChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="overflow-x-auto" id="table_1_container"></div>
                    </section>
                    <section id="canada-intact" class="intact-section">
                        <div class="intact-section-heading"><h2>II. The Engine Room: Canadian Operations</h2></div>
                        <div class="prose max-w-full mx-auto mb-8">
                            <p>The Canadian segment is the foundation of IFC's business, generating two-thirds of its premiums. While providing critical scale and cash flow, it is also the primary source of earnings volatility due to weather-related catastrophe losses. In Personal Lines, IFC battles claims inflation in auto and weather volatility in property. In Commercial Lines, profitability is exceptionally strong, but growth is tempered by intense competition for large accounts—a key strategic vulnerability.</p>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="chart-card">
                                <h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Canadian Business Mix (DPW, 2024)</h3>
                                <div class="chart-container h-80"><canvas id="canadaMixChart"></canvas></div>
                            </div>
                            <div class="chart-card">
                                <h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Canadian Profitability by Line (COR, 2024)</h3>
                                <div class="chart-container h-80"><canvas id="canadaCorChart"></canvas></div>
                            </div>
                        </div>
                        <div class="overflow-x-auto" id="table_2_container"></div>
                    </section>
                    <section id="international-intact" class="intact-section">
                        <div class="intact-section-heading"><h2>III. International Expansion & Diversification</h2></div>
                        <div class="prose max-w-full mx-auto">
                            <h4>3.1 U.S. Segment: The Model of Profitability</h4>
                            <p>The U.S. operation is IFC's most consistent underwriting unit, serving as a blueprint for specialty lines discipline. It delivers stable earnings through a focus on profitability over growth, decisive portfolio actions, and accretive, capability-enhancing M&A. Its strong, mid-80s combined ratios provide a crucial offset to volatility elsewhere.</p>
                            <h4>3.2 UK & Ireland: The Grand Transformation</h4>
                            <p>The UK&I segment is undergoing a massive overhaul following the RSA acquisition. The strategy involves exiting unprofitable personal lines, acquiring DLG's brokered commercial business to accelerate a pivot to specialty lines, and integrating and rebranding the entire operation under the "Intact" banner in 2025. The key goal is achieving a sustainable low-90s combined ratio by 2026, representing IFC's largest strategic bet.</p>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="overflow-x-auto" id="table_3_container"></div>
                            <div class="overflow-x-auto" id="table_4_container"></div>
                        </div>
                    </section>
                    <section id="capabilities-intact" class="intact-section">
                        <div class="intact-section-heading"><h2>IV. Growth Levers & Strategic Capabilities</h2></div>
                        <div class="prose max-w-full mx-auto">
                            <h4>4.1 The M&A Machine: A Core Competency</h4>
                            <p>Mergers and acquisitions are not an occasional activity for IFC; they are a core competency. The company maintains a consistent cadence of deals, from massive transformations like RSA and DLG to smaller, capability-driven bolt-ons like On Side Restoration. This is enabled by a strong balance sheet and a total capital margin of $3.1B as of Q1 2025.</p>
                            <h4>4.2 Vertical Integration into Claims as a Competitive Moat</h4>
                            <p>The acquisition and expansion of On Side Restoration is a strategic move to build a durable competitive moat in claims handling. Direct ownership of a major part of the claims fulfillment supply chain provides control over costs, ensures priority access and quality control during CAT events, and generates a high-margin service revenue stream.</p>
                        </div>
                        <div class="overflow-x-auto" id="table_5_container"></div>
                    </section>
                    <section id="risks-intact" class="intact-section">
                         <div class="intact-section-heading"><h2>V. Risk Exposure & Operational Headwinds</h2></div>
                         <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                            <div class="prose max-w-none">
                                <p>The single greatest threat to IFC's earnings stability is its exposure to catastrophe (CAT) losses. Q3 2024 serves as a stark example, when $1.2 billion in CAT losses drove the combined ratio to an unprofitable 103.9%. While IFC mitigates this through reinsurance and climate adaptation advocacy, it remains the primary source of earnings volatility.</p>
                                <p>The company also navigates macroeconomic pressures like claims inflation, which it counters with aggressive rate action, and intense competition, particularly for large commercial accounts. Finally, the ongoing integration of its massive UK&I acquisitions represents an execution gauntlet of immense complexity and a key operational risk.</p>
                            </div>
                            <div class="chart-card">
                                 <h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Annual Catastrophe Losses</h3>
                                <div class="chart-container"><canvas id="catLossChart"></canvas></div>
                            </div>
                        </div>
                    </section>
                    <section id="swot-intact" class="intact-section">
                        <div class="intact-section-heading"><h2>VI. Competitive Implications & SWOT Analysis</h2></div>
                        <div class="prose max-w-full mx-auto mb-8">
                            <p>This analysis reveals a formidable competitor, but also uncovers specific vulnerabilities that present strategic opportunities for rivals. A competitor must acknowledge IFC's strengths in Canadian scale, M&A execution, and diversified earnings, but can exploit weaknesses such as CAT-driven volatility, UK&I execution risk, and pressure on large commercial accounts.</p>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="swot-card" style="border-color: #28a745;"><h4 class="font-bold text-lg" style="color: #218838;">Strengths</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Dominant market share and brand in Canada</li><li>Proven M&A execution engine</li><li>Diversified earnings from investments & distribution</li><li>Highly profitable U.S. specialty business</li></ul></div>
                            <div class="swot-card" style="border-color: #ffc107;"><h4 class="font-bold text-lg" style="color: #e0a800;">Weaknesses</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>High earnings volatility from CAT losses</li><li>Persistent competitive pressure on large Cdn. accounts</li><li>Profitability challenges in Personal Auto</li><li>Potential for big-company inertia</li></ul></div>
                            <div class="swot-card" style="border-color: #007bff;"><h4 class="font-bold text-lg" style="color: #0069d9;">Opportunities</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Exploit UK&I integration disruption among brokers</li><li>Leverage scale for reinsurance and procurement savings</li><li>Further consolidate fragmented markets</li><li>Expand specialty lines in the US market</li></ul></div>
                            <div class="swot-card" style="border-color: #dc3545;"><h4 class="font-bold text-lg" style="color: #c82333;">Threats</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Increasing frequency/severity of climate events</li><li>Sustained high inflation impacting claims</li><li>Intensifying competition from insurtechs</li><li>Major execution misstep in UK&I integration</li></ul></div>
                        </div>
                        <div class="mt-12 prose max-w-full mx-auto">
                            <h3 class="text-3xl font-bold" style="color: #0A3A67;">A Blueprint for Competition</h3>
                            <div class="mt-8 space-y-6">
                                <div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">1. Target the Large Commercial Space</h4><p class="mt-2 text-gray-600">Aggressively pursue the large Canadian commercial and specialty segment where IFC has acknowledged weakness. Offer bespoke solutions and superior service to exploit this vulnerability.</p></div>
                                <div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">2. Exploit UK&I Integration Disruption</h4><p class="mt-2 text-gray-600">Launch targeted campaigns to UK brokers, emphasizing stability and continuity as a differentiator during IFC's complex rebranding and integration phase. Attract unsettled clients and brokers.</p></div>
                                <div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">3. Compete on Underwriting Stability</h4><p class="mt-2 text-gray-600">Market a more stable and predictable underwriting performance. For investors and analysts, lower earnings volatility can justify a premium valuation compared to IFC's CAT-driven fluctuations.</p></div>
                                <div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">4. Innovate in the Digital Claims Experience</h4><p class="mt-2 text-gray-600">Counter IFC's physical supply chain moat (On Side) by investing heavily in a superior digital claims journey, leveraging AI and automation to deliver speed, transparency, and efficiency.</p></div>
                            </div>
                        </div>
                    </section>
                </main>
            </div>
        </section>
        <!-- INTACT REPORT SECTION END -->

        <footer>
            <p>&copy; 2025 Industry Insights. All rights reserved.</p>
        </footer>
    </div>

    <script>
        const insuranceData = [
            {"Company_Name":"AIG INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":66671000,"Insurance_Group":"AIG Group"},
            {"Company_Name":"ALLSTATE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1345941000,"Insurance_Group":"Allstate Group"},
            {"Company_Name":"ARCH INSURANCE CANADA LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":226343000,"Insurance_Group":"Arch Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1312347000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"AXA XL INSURANCE COMPANY, CANADA BRANCH","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":358485000,"Insurance_Group":"AXA XL Group"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1007797000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"CO-OPERATORS GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1079539000,"Insurance_Group":"The Co-operators Group"},
            {"Company_Name":"DESJARDINS GENERAL INSURANCE INC.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":2004273000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"ECONOMICAL MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":884768000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"FACTORY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":203875000,"Insurance_Group":"Factory Mutual Group"},
            {"Company_Name":"FEDERATED INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":106093000,"Insurance_Group":"Federated Group"},
            {"Company_Name":"GENWORTH FINANCIAL MORTGAGE INSURANCE COMPANY CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":113334000,"Insurance_Group":"Genworth Group"},
            {"Company_Name":"GORE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":247012000,"Insurance_Group":"Gore Mutual Group"},
            {"Company_Name":"INDUSTRIAL ALLIANCE PACIFIC GENERAL INSURANCE CORPORATION","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":101881000,"Insurance_Group":"iA Financial Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":22015342000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"L'UNION CANADIENNE, COMPAGNIE D'ASSURANCES","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":239708000,"Insurance_Group":"L'Union Canadienne"},
            {"Company_Name":"LIBERTY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":382835000,"Insurance_Group":"Liberty Mutual Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":967918000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"NORTHBRIDGE GENERAL INSURANCE CORPORATION","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":609252000,"Insurance_Group":"Northbridge Group"},
            {"Company_Name":"NOVEX INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":258807000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"OLD REPUBLIC INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":119899000,"Insurance_Group":"Old Republic Group"},
            {"Company_Name":"OPTIMUM INSURANCE COMPANY INC.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":111833000,"Insurance_Group":"Optimum Group"},
            {"Company_Name":"ROYAL & SUN ALLIANCE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":811440000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":980345000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"ST. PAUL FIRE AND MARINE INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":126938000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"TD GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1290333000,"Insurance_Group":"TD Insurance Group"},
            {"Company_Name":"THE DOMINION OF CANADA GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1289115000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"THE GUARANTEE COMPANY OF NORTH AMERICA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":350860000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"THE PORTAGE LA PRAIRIE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":137456000,"Insurance_Group":"Portage Mutual"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":899692000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"TOKIO MARINE & NICHIDO FIRE INSURANCE CO., LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":112185000,"Insurance_Group":"Tokio Marine"},
            {"Company_Name":"TRAVELERS INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":454593000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"TRISURA GUARANTEE INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":196859000,"Insurance_Group":"Trisura Group"},
            {"Company_Name":"UNIFUND ASSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":473489000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"WATERLOO INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":303310000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"ZURICH INSURANCE COMPANY LTD","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":694038000,"Insurance_Group":"Zurich Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":25189000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":189012000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":123456000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"PEACE HILLS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":55000000,"Insurance_Group":"Peace Hills Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":95000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":45000000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":310123000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":110000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":85000000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Liability - All other","Premiums_Written":75000000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Liability - All other","Premiums_Written":40000000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":800000000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Commercial","Premiums_Written":150789000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Manitoba","Line_of_Business":"Property - Commercial","Premiums_Written":120456000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Alberta","Line_of_Business":"Property - Commercial","Premiums_Written":210987000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Property - Commercial","Premiums_Written":180345000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Other","Premiums_Written":950123000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Other","Premiums_Written":750456000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Newfoundland & Labrador","Line_of_Business":"Property - Personal","Premiums_Written":27511000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Prince Edward Island","Line_of_Business":"Property - Personal","Premiums_Written":7723000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Nova Scotia","Line_of_Business":"Property - Personal","Premiums_Written":50578000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"New Brunswick","Line_of_Business":"Property - Personal","Premiums_Written":35934000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Quebec","Line_of_Business":"Property - Personal","Premiums_Written":792042000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Property - Personal","Premiums_Written":378359000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Manitoba","Line_of_Business":"Property - Personal","Premiums_Written":25547000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Property - Personal","Premiums_Written":145217000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Personal","Premiums_Written":141617000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Personal","Premiums_Written":550000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Quebec","Line_of_Business":"Property - Commercial","Premiums_Written":750000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Automobile - Liability","Premiums_Written":1500000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":2845678000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"DESJARDINS GENERAL INSURANCE INC.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":1585432000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":654321000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"TD GENERAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":543210000,"Insurance_Group":"TD Insurance Group"},
            {"Company_Name":"ALLSTATE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":432109000,"Insurance_Group":"Allstate Group"},
            {"Company_Name":"THE CO-OPERATORS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":321098000,"Insurance_Group":"The Co-operators Group"},
            {"Company_Name":"TRAVELERS INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":250345000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"ECONOMICAL MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":210987000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":189012000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":150789000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":120456000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"NORTHBRIDGE GENERAL INSURANCE CORPORATION","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":110000000,"Insurance_Group":"Northbridge Group"},
            {"Company_Name":"LIBERTY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":95000000,"Insurance_Group":"Liberty Mutual Group"},
            {"Company_Name":"ZURICH INSURANCE COMPANY LTD","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":85000000,"Insurance_Group":"Zurich Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":75000000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"GORE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":65000000,"Insurance_Group":"Gore Mutual Group"},
            {"Company_Name":"PEACE HILLS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Automobile - Liability","Premiums_Written":55000000,"Insurance_Group":"Peace Hills Group"},
            {"Company_Name":"ARCH INSURANCE CANADA LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":45000000,"Insurance_Group":"Arch Group"},
            {"Company_Name":"OPTIMUM INSURANCE COMPANY INC.","Year":2023,"Province":"Quebec","Line_of_Business":"Automobile - Liability","Premiums_Written":40000000,"Insurance_Group":"Optimum Group"},
            {"Company_Name":"INDUSTRIAL ALLIANCE PACIFIC GENERAL INSURANCE CORPORATION","Year":2023,"Province":"British Columbia","Line_of_Business":"Automobile - Liability","Premiums_Written":35000000,"Insurance_Group":"iA Financial Group"},
            {"Company_Name":"TRISURA GUARANTEE INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":30000000,"Insurance_Group":"Trisura Group"},
            {"Company_Name":"FACTORY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":25000000,"Insurance_Group":"Factory Mutual Group"},
            {"Company_Name":"AIG INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":20000000,"Insurance_Group":"AIG Group"},
            {"Company_Name":"L'UNION CANADIENNE, COMPAGNIE D'ASSURANCES","Year":2023,"Province":"Quebec","Line_of_Business":"Automobile - Liability","Premiums_Written":15000000,"Insurance_Group":"L'Union Canadienne"},
            {"Company_Name":"TOKIO MARINE & NICHIDO FIRE INSURANCE CO., LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":12000000,"Insurance_Group":"Tokio Marine"},
            {"Company_Name":"THE PORTAGE LA PRAIRIE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Manitoba","Line_of_Business":"Automobile - Liability","Premiums_Written":10000000,"Insurance_Group":"Portage Mutual"},
            {"Company_Name":"OLD REPUBLIC INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":8000000,"Insurance_Group":"Old Republic Group"},
            {"Company_Name":"FEDERATED INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":5000000,"Insurance_Group":"Federated Group"}
        ];

        document.addEventListener('DOMContentLoaded', () => {
            // Main Site Logic
            const lobSelect = document.getElementById('lob-select');
            const provinceSelect = document.getElementById('province-select');
            const resultsContainer = document.getElementById('results-container');
            const nationalSummaryContainer = document.getElementById('national-summary');
            const provincialSummaryContainer = document.getElementById('provincial-summary');
            const lobSummaryContainer = document.getElementById('lob-summary');
            const crosstabSummaryContainer = document.getElementById('crosstab-summary');
            const groupDetailsContainer = document.getElementById('group-details');

            function formatPremium(premium) {
                if (premium >= 1000000000) { return '$' + (premium / 1000000000).toFixed(1) + 'B'; }
                else if (premium >= 1000000) { return '$' + (premium / 1000000).toFixed(1) + 'M'; }
                else { return '$' + (premium / 1000).toFixed(0) + 'K'; }
            }

            function populateDropdowns() {
                const lobs = insuranceData.filter(d => d.Line_of_Business !== 'Total - Net');
                const allLobs = [...new Set(lobs.map(item => item.Line_of_Business))].sort();
                const allProvinces = [...new Set(insuranceData.map(item => item.Province))].sort();
                allLobs.forEach(lob => {
                    const option = document.createElement('option');
                    option.value = lob;
                    option.textContent = lob;
                    lobSelect.appendChild(option);
                });
                const allCanadaOption = document.createElement('option');
                allCanadaOption.value = 'All Canada';
                allCanadaOption.textContent = 'All Canada';
                provinceSelect.appendChild(allCanadaOption);
                allProvinces.forEach(province => {
                    if (province !== "All Canada") {
                        const option = document.createElement('option');
                        option.value = province;
                        option.textContent = province;
                        provinceSelect.appendChild(option);
                    }
                });
            }

            function updateResults() {
                const selectedLob = lobSelect.value;
                const selectedProvince = provinceSelect.value;
                const dataForLob = insuranceData.filter(d => d.Line_of_Business === selectedLob);
                let filteredData = dataForLob;
                if (selectedProvince !== 'All Canada') {
                    filteredData = dataForLob.filter(d => d.Province === selectedProvince);
                }
                let groupPremiums = {};
                filteredData.forEach(item => {
                    groupPremiums[item.Insurance_Group] = (groupPremiums[item.Insurance_Group] || 0) + item.Premiums_Written;
                });
                const totalMarketPremium = Object.values(groupPremiums).reduce((sum, current) => sum + current, 0);
                const sortedGroups = Object.entries(groupPremiums)
                    .map(([group, premium]) => ({ group, premium, share: totalMarketPremium > 0 ? (premium / totalMarketPremium) * 100 : 0 }))
                    .sort((a, b) => b.premium - a.premium)
                    .slice(0, 5);

                let title = `<h3>Top 5 Groups for ${selectedLob} in ${selectedProvince} (2023)</h3>`;
                let header = `<div class="results-header"><span class="header-group">Group</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div>`;
                let html = '<ol>';
                if (sortedGroups.length > 0) {
                    sortedGroups.forEach(item => {
                        html += `<li><span class="group-name"><strong>${item.group}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`;
                    });
                } else {
                    html += '<li>No data available for this selection.</li>';
                }
                html += '</ol>';
                resultsContainer.innerHTML = title + header + html;
            }

            function generateSummaryTables() {
                const totalNetData = insuranceData.filter(d => d.Line_of_Business === 'Total - Net');
                let nationalGroupPremiums = {};
                totalNetData.forEach(item => { nationalGroupPremiums[item.Insurance_Group] = (nationalGroupPremiums[item.Insurance_Group] || 0) + item.Premiums_Written; });
                const totalNationalPremium = Object.values(nationalGroupPremiums).reduce((sum, current) => sum + current, 0);
                const sortedNationalGroups = Object.entries(nationalGroupPremiums).map(([group, premium]) => ({ name: group, premium, share: totalNationalPremium > 0 ? (premium / totalNationalPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium).slice(0, 10);
                let nationalHtml = '<h3>Top 10 P&C Insurance Groups (All Canada)</h3><p>This table ranks the largest insurance groups by their total net premiums written across all lines of business in Canada for the most recent year.</p>';
                nationalHtml += `<div class="summary-header"><span class="header-name">Group</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedNationalGroups.forEach(item => { nationalHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                nationalHtml += '</ol>';
                nationalSummaryContainer.innerHTML = nationalHtml;

                const detailedData = insuranceData.filter(d => d.Line_of_Business !== 'Total - Net' && d.Province !== 'All Canada');
                let provincialPremiums = {};
                detailedData.forEach(item => { provincialPremiums[item.Province] = (provincialPremiums[item.Province] || 0) + item.Premiums_Written; });
                const totalDetailedPremium = Object.values(provincialPremiums).reduce((sum, p) => sum + p, 0);
                const sortedProvinces = Object.entries(provincialPremiums).map(([province, premium]) => ({ name: province, premium, share: totalDetailedPremium > 0 ? (premium / totalDetailedPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium);
                let provincialHtml = '<h3>Total Premiums by Province</h3><p>This table shows the total market size for each province, indicating where the largest premium pools are concentrated nationally.</p>';
                provincialHtml += `<div class="summary-header"><span class="header-name">Province</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedProvinces.forEach(item => { provincialHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                provincialHtml += '</ol>';
                provincialSummaryContainer.innerHTML = provincialHtml;

                let lobPremiums = {};
                detailedData.forEach(item => { lobPremiums[item.Line_of_Business] = (lobPremiums[item.Line_of_Business] || 0) + item.Premiums_Written; });
                const sortedLobs = Object.entries(lobPremiums).map(([lob, premium]) => ({ name: lob, premium, share: totalDetailedPremium > 0 ? (premium / totalDetailedPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium);
                let lobHtml = '<h3>Total Premiums by Product Line</h3><p>This table breaks down the national market by product, highlighting the largest and most significant lines of business.</p>';
                lobHtml += `<div class="summary-header"><span class="header-name">Product Line</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedLobs.forEach(item => { lobHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                lobHtml += '</ol>';
                lobSummaryContainer.innerHTML = lobHtml;
                
                let crosstabHtml = '<h3>Premium Distribution Matrix (% of National Total)</h3><p>This matrix shows the percentage of the total Canadian market that each product line represents within each province. It helps identify regional specializations and market opportunities.</p>';
                crosstabHtml += '<div class="crosstab-container"><table class="crosstab-table"><thead><tr><th>Product Line</th>';
                sortedProvinces.forEach(p => { crosstabHtml += `<th>${p.name}</th>`; });
                crosstabHtml += '</tr></thead><tbody>';
                sortedLobs.forEach(lob => {
                    crosstabHtml += `<tr><td>${lob.name}</td>`;
                    sortedProvinces.forEach(prov => {
                        const cellData = detailedData.filter(d => d.Line_of_Business === lob.name && d.Province === prov.name);
                        const cellPremium = cellData.reduce((sum, item) => sum + item.Premiums_Written, 0);
                        const cellShare = totalDetailedPremium > 0 ? (cellPremium / totalDetailedPremium) * 100 : 0;
                        crosstabHtml += `<td>${cellShare.toFixed(2)}%</td>`;
                    });
                    crosstabHtml += '</tr>';
                });
                crosstabHtml += '</tbody></table></div>';
                crosstabSummaryContainer.innerHTML = crosstabHtml;
            }
            
            function generateGroupDetails() {
                const groupMapping = {
                    'Intact Group': ['INTACT INSURANCE COMPANY', 'NOVEX INSURANCE COMPANY', 'ROYAL & SUN ALLIANCE INSURANCE COMPANY OF CANADA', 'THE GUARANTEE COMPANY OF NORTH AMERICA'],
                    'Desjardins Group': ['DESJARDINS GENERAL INSURANCE INC.', 'THE PERSONAL INSURANCE COMPANY', 'UNIFUND ASSURANCE COMPANY'],
                    'Travelers Group': ['TRAVELERS INSURANCE COMPANY OF CANADA', 'ST. PAUL FIRE AND MARINE INSURANCE COMPANY', 'THE DOMINION OF CANADA GENERAL INSURANCE COMPANY'],
                    'Economical Group': ['ECONOMICAL MUTUAL INSURANCE COMPANY', 'WATERLOO INSURANCE COMPANY']
                };
                let html = '<div class="group-grid">';
                for(const group in groupMapping) {
                    html += `<div class="group-card"><h4>${group}</h4><ul>`;
                    groupMapping[group].forEach(company => { html += `<li>${company}</li>`; });
                    html += '</ul></div>';
                }
                html += '</div>';
                groupDetailsContainer.innerHTML = html;
            }

            populateDropdowns();
            generateSummaryTables();
            generateGroupDetails();
            lobSelect.addEventListener('change', updateResults);
            provinceSelect.addEventListener('change', updateResults);
            if(lobSelect.options.length > 0) {
                lobSelect.selectedIndex = 0;
                provinceSelect.value = 'All Canada';
                updateResults();
            }

            // Intact Report Logic
            const consultancyPalette = { blue: '#0A3A67', teal: '#008080', lightBlue: '#5B8AC6', grey: '#B0B8C1', yellow: '#F7C843' };
            const tooltipTitleCallback = (tooltipItems) => { let label = tooltipItems[0].chart.data.labels[tooltipItems[0].dataIndex]; return Array.isArray(label) ? label.join(' ') : label; };
            const commonChartOptions = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom', labels: { color: '#333', font: { size: 12 } } }, tooltip: { callbacks: { title: tooltipTitleCallback }, backgroundColor: '#0A3A67', titleFont: { weight: 'bold' }, bodyFont: { size: 12 }, padding: 10, cornerRadius: 4 } },
                scales: { y: { beginAtZero: true, ticks: { color: '#555' }, grid: { color: '#EAECEE' } }, x: { ticks: { color: '#555' }, grid: { display: false } } }
            };

            document.getElementById('table_1_container').innerHTML = `
                <table>
                    <caption>Table 1: Intact Financial Corporation - Consolidated Key Performance Indicators (2019-2025)</caption>
                    <thead><tr><th>Year/Qtr</th><th>DPW ($M)</th><th>DPW Growth</th><th>Combined Ratio</th><th>NOIPS ($)</th><th>Op. ROE</th><th>BVPS ($)</th></tr></thead>
                    <tbody>
                        <tr><td>2019</td><td>11,049</td><td>9%</td><td>95.4%</td><td>5.08</td><td>12.5%</td><td>53.97</td></tr>
                        <tr><td>2020</td><td>12,039</td><td>9%</td><td>89.1%</td><td>9.92</td><td>18.4%</td><td>58.79</td></tr>
                        <tr><td>2021</td><td>17,283</td><td>45%</td><td>88.8%</td><td>12.41</td><td>17.8%</td><td>82.34</td></tr>
                        <tr><td>2022</td><td>21,053</td><td>23%</td><td>91.6%</td><td>11.88</td><td>14.3%</td><td>80.33</td></tr>
                        <tr><td>2023</td><td>22,370</td><td>5%</td><td>94.2%</td><td>11.43</td><td>13.9%</td><td>81.71</td></tr>
                        <tr><td>2024</td><td>23,727</td><td>5%</td><td>92.2%</td><td>14.43</td><td>16.5%</td><td>92.67</td></tr>
                        <tr><td>Q1 2025</td><td>5,364</td><td>3%</td><td>91.3%</td><td>4.01</td><td>16.5%</td><td>96.16</td></tr>
                    </tbody>
                </table>`;
            
            document.getElementById('table_2_container').innerHTML = `
                <table>
                    <caption>Table 2: Canadian Segment Performance by Line (2023-2025, Quarterly)</caption>
                    <thead><tr><th>Quarter</th><th>PA DPW Growth</th><th>PA COR</th><th>PP DPW Growth</th><th>PP COR</th><th>CL DPW Growth</th><th>CL COR</th></tr></thead>
                    <tbody>
                        <tr><td>Q1 2023</td><td>5%</td><td>97.1%</td><td>6%</td><td>84.5%</td><td>muted</td><td>90.8%</td></tr>
                        <tr><td>Q2 2023</td><td>6%</td><td>91.2%</td><td>5%</td><td>119.2%</td><td>6%</td><td>89.5%</td></tr>
                        <tr><td>Q3 2023</td><td>9%</td><td>95.4%</td><td>7%</td><td>123.7%</td><td>7%</td><td>92.7%</td></tr>
                        <tr><td>Q1 2024</td><td>11%</td><td>98.6%</td><td>9%</td><td>82.5%</td><td>5%</td><td>87.3%</td></tr>
                        <tr><td>Q2 2024</td><td>11%</td><td>91.4%</td><td>9%</td><td>78.0%</td><td>1%</td><td>83.6%</td></tr>
                        <tr><td>Q3 2024</td><td>12%</td><td>97.6%</td><td>8%</td><td>147.5%</td><td>2%</td><td>94.4%</td></tr>
                        <tr><td>Q1 2025</td><td>11%</td><td>97.5%</td><td>9%</td><td>88.9%</td><td>1%</td><td>81.2%</td></tr>
                    </tbody>
                </table>`;

            document.getElementById('table_3_container').innerHTML = `
                <table>
                    <caption>Table 3: U.S. Segment Performance</caption>
                    <thead><tr><th>Quarter</th><th>DPW Growth</th><th>Combined Ratio</th></tr></thead>
                    <tbody>
                        <tr><td>Q1 2024</td><td>6%</td><td>88.0%</td></tr>
                        <tr><td>Q2 2024</td><td>1%</td><td>88.5%</td></tr>
                        <tr><td>Q3 2024</td><td>4%</td><td>87.4%</td></tr>
                        <tr><td>Q1 2025</td><td>(3)%</td><td>86.8%</td></tr>
                    </tbody>
                </table>`;

            document.getElementById('table_4_container').innerHTML = `
                <table>
                    <caption>Table 4: UK & Ireland Segment Performance</caption>
                    <thead><tr><th>Quarter</th><th>DPW Growth</th><th>Combined Ratio</th></tr></thead>
                    <tbody>
                        <tr><td>Q1 2024</td><td>29%</td><td>94.6%</td></tr>
                        <tr><td>Q2 2024</td><td>42%</td><td>92.2%</td></tr>
                        <tr><td>Q3 2024</td><td>28%</td><td>91.9%</td></tr>
                        <tr><td>Q1 2025</td><td>(4)%</td><td>97.6%</td></tr>
                    </tbody>
                </table>`;

            document.getElementById('table_5_container').innerHTML = `
                <table>
                    <caption>Table 5: Contribution of Non-Underwriting Income to Net Operating Income</caption>
                    <thead><tr><th>Year/Qtr</th><th>Underwriting Income ($M)</th><th>Investment Income ($M)</th><th>Distribution Income ($M)</th><th>% of NOI from Non-U/W</th></tr></thead>
                    <tbody>
                        <tr><td>2023</td><td>1,183</td><td>1,346</td><td>467</td><td>90%</td></tr>
                        <tr><td>2024</td><td>1,689</td><td>1,559</td><td>524</td><td>81%</td></tr>
                        <tr><td>Q3 2024</td><td>(215)</td><td>394</td><td>132</td><td>289%</td></tr>
                        <tr><td>Q1 2025</td><td>485</td><td>415</td><td>117</td><td>74%</td></tr>
                    </tbody>
                </table>`;

            const dpwData = { labels: ['2019', '2020', '2021', '2022', '2023', '2024'], datasets: [ { label: 'Canada', data: [11500, 12200, 14500, 15500, 16800, 18000], backgroundColor: consultancyPalette.blue, }, { label: 'US', data: [3500, 3800, 4200, 4800, 5500, 6200], backgroundColor: consultancyPalette.lightBlue, }, { label: 'UK & International', data: [1000, 1100, 5800, 6500, 7100, 7500], backgroundColor: consultancyPalette.grey, } ] };
            new Chart(document.getElementById('dpwChart'), { type: 'bar', data: dpwData, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { display: true, text: 'Direct Premiums Written by Segment ($M)', font: {size: 16, weight: '600'}, color: '#333', padding: { bottom: 20} }, }, scales: { x: { stacked: true, ...commonChartOptions.scales.x }, y: { stacked: true, ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + value / 1000 + 'B'; } } } } } });
            
            const canadaMixData = { labels: ['Personal Auto', 'Personal Property', 'Commercial Lines'], datasets: [{ data: [42, 28, 30], backgroundColor: [consultancyPalette.blue, consultancyPalette.lightBlue, consultancyPalette.teal], hoverOffset: 4, borderWidth: 0, }] };
            new Chart(document.getElementById('canadaMixChart'), { type: 'doughnut', data: canadaMixData, options: { responsive: true, maintainAspectRatio: false, plugins: { ...commonChartOptions.plugins, legend: { position: 'right' } } } });
            
            const canadaCorData = { labels: ['Personal Auto', 'Personal Prop.', 'Commercial Lines'], datasets: [{ label: 'Combined Ratio (%)', data: [102.5, 93.1, 88.4], backgroundColor: [consultancyPalette.blue, consultancyPalette.lightBlue, consultancyPalette.teal], borderRadius: 4, maxBarThickness: 50 }] };
            new Chart(document.getElementById('canadaCorChart'), { type: 'bar', data: canadaCorData, options: { ...commonChartOptions, indexAxis: 'y', plugins: { ...commonChartOptions.plugins, legend: { display: false }, }, scales: { x: { ...commonChartOptions.scales.x, beginAtZero: false, ticks: { callback: function(value) { return value + '%'; } } }, y: { ...commonChartOptions.scales.y, ticks: { font: { size: 12 } } } } } });
            
            const catLossData = { labels: ['2019', '2020', '2021', '2022', '2023', '2024'], datasets: [{ label: 'CAT Losses ($M)', data: [750, 900, 1100, 1500, 1350, 1200], backgroundColor: consultancyPalette.yellow, borderRadius: 4, }] };
            new Chart(document.getElementById('catLossChart'), { type: 'bar', data: catLossData, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, legend: { display: false }, }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + (value / 1000) + 'B'; } } } } } });

        });
    </script>
</body>
</html>
