<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Insurer Insights</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Reset & Base Styles --- */
        :root {
            --primary-color: #005f73;
            --secondary-color: #008c9e;
            --dark-text: #212529;
            --light-text: #6c757d;
            --background-color: #f8f9fa;
            --container-bg: #ffffff;
            --border-color: #dee2e6;
            --highlight-bg: #eef7ff;
        }
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.7;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--dark-text);
        }

        /* --- Navigation Bar --- */
        nav {
            background-color: var(--container-bg);
            padding: 0 5%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }
        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }
        nav ul li a {
            display: block;
            padding: 20px 15px;
            text-decoration: none;
            color: var(--dark-text);
            font-weight: 600;
            transition: color 0.3s ease;
        }
        nav ul li a:hover {
            color: var(--primary-color);
        }

        /* --- Hero Section (Homepage) --- */
        .hero {
            height: 70vh;
            min-height: 400px;
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            padding: 0 20px;
        }
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        .hero p {
            font-size: 1.5rem;
            max-width: 700px;
            margin-bottom: 30px;
            color: rgba(255,255,255,0.9);
        }
        .hero-button {
            background-color: var(--secondary-color);
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        .hero-button:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }

        /* --- Layout & Container --- */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
            padding: 40px;
            background-color: var(--container-bg);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.05);
        }

        /* --- Section & Typography --- */
        section {
            margin-bottom: 50px;
            padding-top: 60px; /* For nav anchor offset */
            margin-top: -60px; /* For nav anchor offset */
        }
        h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
            font-weight: 600;
        }
        h3 {
             color: var(--dark-text);
             font-size: 1.4rem;
             margin-bottom: 20px;
        }
        p {
            font-size: 1.1rem;
            color: var(--dark-text);
        }

        /* --- Interactive Filters --- */
        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #fdfdff;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        label {
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            font-size: 1.1em;
            color: var(--primary-color);
        }
        select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            background-color: #fff;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236c757d%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 0.65em auto;
            cursor: pointer;
        }

        /* --- Results & Lists --- */
        #results-container {
            margin-top: 20px;
            padding: 25px;
            background-color: var(--highlight-bg);
            border-radius: 8px;
            border: 1px solid #cce7ff;
        }
        #results-container h3 {
            margin-top: 0;
            color: var(--primary-color);
            font-size: 1.4rem;
        }
        .results-header, .summary-header {
            display: flex;
            justify-content: space-between;
            font-weight: 700;
            color: var(--dark-text);
            padding: 0 20px 10px 45px;
            border-bottom: 2px solid var(--border-color);
        }
        .summary-header {
             padding-left: 20px;
        }
        .results-header .header-group, .summary-header .header-name {
            flex-grow: 1;
        }
        .results-header .header-premium, .results-header .header-share,
        .summary-header .header-premium, .summary-header .header-share {
            text-align: right;
            width: 140px;
        }
        ol {
            list-style-type: none;
            padding-left: 0;
            counter-reset: item;
        }
        ol li {
            background-color: var(--container-bg);
            margin-bottom: 12px;
            padding: 15px 20px;
            border: 1px solid var(--border-color);
            font-size: 1.1em;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        ol li::before {
            content: counter(item) ".";
            counter-increment: item;
            margin-right: 15px;
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.2em;
        }
        .summary-list li::before {
            content: '';
            margin-right: 0;
        }
        .group-name, .summary-name {
            flex-grow: 1;
        }
        .premium-value, .share-value {
            text-align: right;
            width: 140px;
            font-weight: 600;
        }
        .share-value {
             color: var(--secondary-color);
        }

        /* --- Cross-Tab Table --- */
        .crosstab-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .crosstab-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            white-space: nowrap;
        }
        .crosstab-table th, .crosstab-table td {
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            text-align: right;
        }
        .crosstab-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        .crosstab-table td:first-child, .crosstab-table th:first-child {
            text-align: left;
            font-weight: 700;
            position: sticky;
            left: 0;
            background-color: #f8f9fa;
        }
        
        /* --- Company Groups Section --- */
        .group-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .group-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }
        .group-card h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        .group-card ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .group-card ul li {
            padding: 5px 0;
            border-bottom: 1px solid #f1f1f1;
        }

        /* --- Footer --- */
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--light-text);
        }

        /* --- COMPANY REPORT STYLES (SHARED) --- */
        .report-section-wrapper {
            background-color: #F0F2F5;
            color: #333333;
            border-radius: 12px;
            padding: 40px;
            margin-top: 40px;
        }
        .report-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .report-main {
            display: flex;
            flex-direction: column;
            gap: 6rem;
        }
        .report-section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        .report-section-heading {
            border-bottom: 2px solid #D9DDE1;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        .report-section-heading h2 {
            color: #0A3A67;
            font-size: 2.5rem;
            font-weight: 700;
            border: none;
            padding: 0;
            margin: 0;
        }
        .kpi-card {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.5rem;
            text-align: center;
            border: 1px solid #D9DDE1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .kpi-card .kpi-value {
            color: #0A3A67;
            font-weight: 700;
            font-size: 3.5rem;
        }
        .kpi-card .kpi-label {
            color: #555;
            font-weight: 600;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .prose {
            color: #333333;
            max-width: 100%;
        }
        .prose h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #0A3A67;
            border-bottom: 1px solid #D9DDE1;
            padding-bottom: 0.5rem;
        }
        .prose p { line-height: 1.7; margin-bottom: 1rem; }
        .prose ul { list-style-position: outside; padding-left: 1rem; margin-bottom: 1rem; }
        .prose li { padding-left: 0.5rem; margin-bottom: 0.75rem; background: none; border: none; }
        .prose b { color: #0A3A67; }
        .chart-card {
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid #D9DDE1;
        }
        .chart-container { position: relative; width: 100%; height: 320px; }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        .report-section-wrapper table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.03);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .report-section-wrapper th, .report-section-wrapper td { text-align: left; padding: 1rem 1.25rem; border-bottom: 1px solid #D9DDE1; }
        .report-section-wrapper thead th { background-color: #F0F2F5; font-weight: 600; color: #0A3A67; }
        .report-section-wrapper tbody tr:nth-child(even) { background-color: #FAFAFB; }
        .swot-card {
            background-color: white; border-radius: 0.5rem; padding: 1.5rem;
            border: 1px solid #D9DDE1; border-left-width: 5px;
        }
        .recommendation-card {
            background-color: #FFFFFF; border-radius: 0.5rem; padding: 1.5rem;
            border: 1px solid #D9DDE1; transition: all 0.2s ease-in-out;
        }
        .recommendation-card:hover {
             box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -4px rgb(0 0 0 / 0.07);
             border-left: 4px solid #008080;
        }
        
        /* --- Mobile Responsiveness --- */
        @media (max-width: 768px) {
            .container { width: 95%; padding: 20px; }
            .hero h1 { font-size: 2.5rem; }
            .hero p { font-size: 1.2rem; }
            .filters { grid-template-columns: 1fr; }
            .results-header, .summary-header { padding: 0 10px 10px 10px; font-size: 0.9em; }
            .results-header .header-premium, .results-header .header-share,
            .summary-header .header-premium, .summary-header .header-share { width: 90px; }
            ol li::before { display: none; }
            ol li { flex-wrap: wrap; }
            .group-name, .summary-name { width: 100%; margin-bottom: 5px; }
            .premium-value, .share-value { width: 50%; text-align: left; font-size: 1em; }
            .report-section-wrapper { padding: 20px; }
            .report-section-heading h2 { font-size: 2rem; }
            .kpi-card .kpi-value { font-size: 2.5rem; }
        }
    </style>
</head>
<body>
    <nav>
        <a href="#home" class="logo">Industry Insights</a>
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#data-explorer">Data Explorer</a></li>
            <li><a href="#market-overview">Market Overview</a></li>
            <li><a href="#intact-report">Intact Deep-Dive</a></li>
            <li><a href="#definity-report">Definity Deep-Dive</a></li>
        </ul>
    </nav>

    <section id="home" class="hero">
        <h1>Clarity in a Complex Market</h1>
        <p>Your data-driven guide to the Canadian Property & Casualty insurance market. We provide clear analysis of market share, industry trends, and the key players shaping the future of insurance.</p>
        <a href="#data-explorer" class="hero-button">Explore the Data</a>
    </section>

    <div class="container">
        <section id="data-explorer">
            <h2>Explore Market Share by Product and Province</h2>
            <p>Select a line of business and a province to see the top 5 insurance groups by market share in 2023.</p>
            <div class="filters">
                <div>
                    <label for="lob-select">Select a Product:</label>
                    <select id="lob-select"></select>
                </div>
                <div>
                    <label for="province-select">Select a Province:</label>
                    <select id="province-select"></select>
                </div>
            </div>
            <div id="results-container"></div>
        </section>

        <section id="market-overview">
            <h2>Canadian Market Overview (2023)</h2>
            <div id="national-summary"></div>
            <div id="provincial-summary" style="margin-top: 40px;"></div>
            <div id="lob-summary" style="margin-top: 40px;"></div>
            <div id="crosstab-summary" style="margin-top: 40px;"></div>
        </section>
        
        <section id="company-groups">
            <h2>Company Groups Explained</h2>
            <p>Market share is often consolidated under parent groups. This table shows which individual companies are included in the major groups for our analysis.</p>
            <div id="group-details"></div>
        </section>

        <!-- INTACT REPORT SECTION START -->
        <section id="intact-report" class="report-section-wrapper">
            <div class="report-container">
                <header class="text-center pt-12 pb-20">
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight" style="color: #0A3A67;">Competitive Intelligence Report:<br>Intact Financial Corporation</h1>
                    <p class="text-xl text-gray-600 mt-6 max-w-4xl mx-auto">An exhaustive analysis of strategy, performance, and vulnerabilities from 2019 to 2025, revealing key opportunities for competitors.</p>
                </header>
                <main class="report-main" id="intact-main-content">
                    <!-- Intact Content will be dynamically injected here by JS -->
                </main>
            </div>
        </section>
        <!-- INTACT REPORT SECTION END -->

        <!-- DEFINITY REPORT SECTION START -->
        <section id="definity-report" class="report-section-wrapper">
            <div class="report-container">
                <header class="text-center pt-12 pb-20">
                    <h1 class="text-4xl md:text-6xl font-bold leading-tight" style="color: #0A3A67;">Competitive Intelligence Report:<br>Definity Financial Corporation</h1>
                    <p class="text-xl text-gray-600 mt-6 max-w-4xl mx-auto">An in-depth analysis of Definity's strategy, performance, and market position following its historic demutualization.</p>
                </header>
                <main class="report-main" id="definity-main-content">
                     <!-- Definity Content will be dynamically injected here by JS -->
                </main>
            </div>
        </section>
        <!-- DEFINITY REPORT SECTION END -->

        <footer>
            <p>&copy; 2025 Industry Insights. All rights reserved.</p>
        </footer>
    </div>

    <script>
        const insuranceData = [
            {"Company_Name":"AIG INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":66671000,"Insurance_Group":"AIG Group"},
            {"Company_Name":"ALLSTATE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1345941000,"Insurance_Group":"Allstate Group"},
            {"Company_Name":"ARCH INSURANCE CANADA LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":226343000,"Insurance_Group":"Arch Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1312347000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"AXA XL INSURANCE COMPANY, CANADA BRANCH","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":358485000,"Insurance_Group":"AXA XL Group"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1007797000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"CO-OPERATORS GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1079539000,"Insurance_Group":"The Co-operators Group"},
            {"Company_Name":"DESJARDINS GENERAL INSURANCE INC.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":2004273000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"ECONOMICAL MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":884768000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"FACTORY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":203875000,"Insurance_Group":"Factory Mutual Group"},
            {"Company_Name":"FEDERATED INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":106093000,"Insurance_Group":"Federated Group"},
            {"Company_Name":"GENWORTH FINANCIAL MORTGAGE INSURANCE COMPANY CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":113334000,"Insurance_Group":"Genworth Group"},
            {"Company_Name":"GORE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":247012000,"Insurance_Group":"Gore Mutual Group"},
            {"Company_Name":"INDUSTRIAL ALLIANCE PACIFIC GENERAL INSURANCE CORPORATION","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":101881000,"Insurance_Group":"iA Financial Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":22015342000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"L'UNION CANADIENNE, COMPAGNIE D'ASSURANCES","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":239708000,"Insurance_Group":"L'Union Canadienne"},
            {"Company_Name":"LIBERTY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":382835000,"Insurance_Group":"Liberty Mutual Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":967918000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"NORTHBRIDGE GENERAL INSURANCE CORPORATION","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":609252000,"Insurance_Group":"Northbridge Group"},
            {"Company_Name":"NOVEX INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":258807000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"OLD REPUBLIC INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":119899000,"Insurance_Group":"Old Republic Group"},
            {"Company_Name":"OPTIMUM INSURANCE COMPANY INC.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":111833000,"Insurance_Group":"Optimum Group"},
            {"Company_Name":"ROYAL & SUN ALLIANCE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":811440000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":980345000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"ST. PAUL FIRE AND MARINE INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":126938000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"TD GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1290333000,"Insurance_Group":"TD Insurance Group"},
            {"Company_Name":"THE DOMINION OF CANADA GENERAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":1289115000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"THE GUARANTEE COMPANY OF NORTH AMERICA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":350860000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"THE PORTAGE LA PRAIRIE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":137456000,"Insurance_Group":"Portage Mutual"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":899692000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"TOKIO MARINE & NICHIDO FIRE INSURANCE CO., LTD.","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":112185000,"Insurance_Group":"Tokio Marine"},
            {"Company_Name":"TRAVELERS INSURANCE COMPANY OF CANADA","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":454593000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"TRISURA GUARANTEE INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":196859000,"Insurance_Group":"Trisura Group"},
            {"Company_Name":"UNIFUND ASSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":473489000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"WATERLOO INSURANCE COMPANY","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":303310000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"ZURICH INSURANCE COMPANY LTD","Year":2023,"Province":"All Canada","Line_of_Business":"Total - Net","Premiums_Written":694038000,"Insurance_Group":"Zurich Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":25189000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":189012000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":123456000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"PEACE HILLS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":55000000,"Insurance_Group":"Peace Hills Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":95000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Personal","Premiums_Written":45000000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":310123000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":110000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Property - Commercial","Premiums_Written":85000000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Liability - All other","Premiums_Written":75000000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Saskatchewan","Line_of_Business":"Liability - All other","Premiums_Written":40000000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":800000000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Commercial","Premiums_Written":150789000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Manitoba","Line_of_Business":"Property - Commercial","Premiums_Written":120456000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Alberta","Line_of_Business":"Property - Commercial","Premiums_Written":210987000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Property - Commercial","Premiums_Written":180345000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Other","Premiums_Written":950123000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Other","Premiums_Written":750456000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Newfoundland & Labrador","Line_of_Business":"Property - Personal","Premiums_Written":27511000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Prince Edward Island","Line_of_Business":"Property - Personal","Premiums_Written":7723000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Nova Scotia","Line_of_Business":"Property - Personal","Premiums_Written":50578000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"New Brunswick","Line_of_Business":"Property - Personal","Premiums_Written":35934000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Quebec","Line_of_Business":"Property - Personal","Premiums_Written":792042000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Property - Personal","Premiums_Written":378359000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Manitoba","Line_of_Business":"Property - Personal","Premiums_Written":25547000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Property - Personal","Premiums_Written":145217000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"THE PERSONAL INSURANCE COMPANY","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Personal","Premiums_Written":141617000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"British Columbia","Line_of_Business":"Property - Personal","Premiums_Written":550000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Quebec","Line_of_Business":"Property - Commercial","Premiums_Written":750000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Automobile - Liability","Premiums_Written":1500000000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"INTACT INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":2845678000,"Insurance_Group":"Intact Group"},
            {"Company_Name":"DESJARDINS GENERAL INSURANCE INC.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":1585432000,"Insurance_Group":"Desjardins Group"},
            {"Company_Name":"AVIVA INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":654321000,"Insurance_Group":"Aviva Canada Group"},
            {"Company_Name":"TD GENERAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":543210000,"Insurance_Group":"TD Insurance Group"},
            {"Company_Name":"ALLSTATE INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":432109000,"Insurance_Group":"Allstate Group"},
            {"Company_Name":"THE CO-OPERATORS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":321098000,"Insurance_Group":"The Co-operators Group"},
            {"Company_Name":"TRAVELERS INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":250345000,"Insurance_Group":"Travelers Group"},
            {"Company_Name":"ECONOMICAL MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":210987000,"Insurance_Group":"Economical Group"},
            {"Company_Name":"THE WAWANESA MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":189012000,"Insurance_Group":"Wawanesa Group"},
            {"Company_Name":"CHUBB INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":150789000,"Insurance_Group":"Chubb Group"},
            {"Company_Name":"SGI CANADA INSURANCE SERVICES LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":120456000,"Insurance_Group":"SGI Canada"},
            {"Company_Name":"NORTHBRIDGE GENERAL INSURANCE CORPORATION","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":110000000,"Insurance_Group":"Northbridge Group"},
            {"Company_Name":"LIBERTY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":95000000,"Insurance_Group":"Liberty Mutual Group"},
            {"Company_Name":"ZURICH INSURANCE COMPANY LTD","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":85000000,"Insurance_Group":"Zurich Group"},
            {"Company_Name":"LLOYD'S UNDERWRITERS","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":75000000,"Insurance_Group":"Lloyd's Underwriters"},
            {"Company_Name":"GORE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":65000000,"Insurance_Group":"Gore Mutual Group"},
            {"Company_Name":"PEACE HILLS GENERAL INSURANCE COMPANY","Year":2023,"Province":"Alberta","Line_of_Business":"Automobile - Liability","Premiums_Written":55000000,"Insurance_Group":"Peace Hills Group"},
            {"Company_Name":"ARCH INSURANCE CANADA LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":45000000,"Insurance_Group":"Arch Group"},
            {"Company_Name":"OPTIMUM INSURANCE COMPANY INC.","Year":2023,"Province":"Quebec","Line_of_Business":"Automobile - Liability","Premiums_Written":40000000,"Insurance_Group":"Optimum Group"},
            {"Company_Name":"INDUSTRIAL ALLIANCE PACIFIC GENERAL INSURANCE CORPORATION","Year":2023,"Province":"British Columbia","Line_of_Business":"Automobile - Liability","Premiums_Written":35000000,"Insurance_Group":"iA Financial Group"},
            {"Company_Name":"TRISURA GUARANTEE INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":30000000,"Insurance_Group":"Trisura Group"},
            {"Company_Name":"FACTORY MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":25000000,"Insurance_Group":"Factory Mutual Group"},
            {"Company_Name":"AIG INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":20000000,"Insurance_Group":"AIG Group"},
            {"Company_Name":"L'UNION CANADIENNE, COMPAGNIE D'ASSURANCES","Year":2023,"Province":"Quebec","Line_of_Business":"Automobile - Liability","Premiums_Written":15000000,"Insurance_Group":"L'Union Canadienne"},
            {"Company_Name":"TOKIO MARINE & NICHIDO FIRE INSURANCE CO., LTD.","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":12000000,"Insurance_Group":"Tokio Marine"},
            {"Company_Name":"THE PORTAGE LA PRAIRIE MUTUAL INSURANCE COMPANY","Year":2023,"Province":"Manitoba","Line_of_Business":"Automobile - Liability","Premiums_Written":10000000,"Insurance_Group":"Portage Mutual"},
            {"Company_Name":"OLD REPUBLIC INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":8000000,"Insurance_Group":"Old Republic Group"},
            {"Company_Name":"FEDERATED INSURANCE COMPANY OF CANADA","Year":2023,"Province":"Ontario","Line_of_Business":"Automobile - Liability","Premiums_Written":5000000,"Insurance_Group":"Federated Group"}
        ];

        document.addEventListener('DOMContentLoaded', () => {
            // Main Site Logic
            const lobSelect = document.getElementById('lob-select');
            const provinceSelect = document.getElementById('province-select');
            const resultsContainer = document.getElementById('results-container');
            const nationalSummaryContainer = document.getElementById('national-summary');
            const provincialSummaryContainer = document.getElementById('provincial-summary');
            const lobSummaryContainer = document.getElementById('lob-summary');
            const crosstabSummaryContainer = document.getElementById('crosstab-summary');
            const groupDetailsContainer = document.getElementById('group-details');

            function formatPremium(premium) {
                if (premium >= 1000000000) { return '$' + (premium / 1000000000).toFixed(1) + 'B'; }
                else if (premium >= 1000000) { return '$' + (premium / 1000000).toFixed(1) + 'M'; }
                else { return '$' + (premium / 1000).toFixed(0) + 'K'; }
            }

            function populateDropdowns() {
                const lobs = insuranceData.filter(d => d.Line_of_Business !== 'Total - Net');
                const allLobs = [...new Set(lobs.map(item => item.Line_of_Business))].sort();
                const allProvinces = [...new Set(insuranceData.map(item => item.Province))].sort();
                allLobs.forEach(lob => {
                    const option = document.createElement('option');
                    option.value = lob;
                    option.textContent = lob;
                    lobSelect.appendChild(option);
                });
                const allCanadaOption = document.createElement('option');
                allCanadaOption.value = 'All Canada';
                allCanadaOption.textContent = 'All Canada';
                provinceSelect.appendChild(allCanadaOption);
                allProvinces.forEach(province => {
                    if (province !== "All Canada") {
                        const option = document.createElement('option');
                        option.value = province;
                        option.textContent = province;
                        provinceSelect.appendChild(option);
                    }
                });
            }

            function updateResults() {
                const selectedLob = lobSelect.value;
                const selectedProvince = provinceSelect.value;
                const dataForLob = insuranceData.filter(d => d.Line_of_Business === selectedLob);
                let filteredData = dataForLob;
                if (selectedProvince !== 'All Canada') {
                    filteredData = dataForLob.filter(d => d.Province === selectedProvince);
                }
                let groupPremiums = {};
                filteredData.forEach(item => {
                    groupPremiums[item.Insurance_Group] = (groupPremiums[item.Insurance_Group] || 0) + item.Premiums_Written;
                });
                const totalMarketPremium = Object.values(groupPremiums).reduce((sum, current) => sum + current, 0);
                const sortedGroups = Object.entries(groupPremiums)
                    .map(([group, premium]) => ({ group, premium, share: totalMarketPremium > 0 ? (premium / totalMarketPremium) * 100 : 0 }))
                    .sort((a, b) => b.premium - a.premium)
                    .slice(0, 5);

                let title = `<h3>Top 5 Groups for ${selectedLob} in ${selectedProvince} (2023)</h3>`;
                let header = `<div class="results-header"><span class="header-group">Group</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div>`;
                let html = '<ol>';
                if (sortedGroups.length > 0) {
                    sortedGroups.forEach(item => {
                        html += `<li><span class="group-name"><strong>${item.group}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`;
                    });
                } else {
                    html += '<li>No data available for this selection.</li>';
                }
                html += '</ol>';
                resultsContainer.innerHTML = title + header + html;
            }

            function generateSummaryTables() {
                const totalNetData = insuranceData.filter(d => d.Line_of_Business === 'Total - Net');
                let nationalGroupPremiums = {};
                totalNetData.forEach(item => { nationalGroupPremiums[item.Insurance_Group] = (nationalGroupPremiums[item.Insurance_Group] || 0) + item.Premiums_Written; });
                const totalNationalPremium = Object.values(nationalGroupPremiums).reduce((sum, current) => sum + current, 0);
                const sortedNationalGroups = Object.entries(nationalGroupPremiums).map(([group, premium]) => ({ name: group, premium, share: totalNationalPremium > 0 ? (premium / totalNationalPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium).slice(0, 10);
                let nationalHtml = '<h3>Top 10 P&C Insurance Groups (All Canada)</h3><p>This table ranks the largest insurance groups by their total net premiums written across all lines of business in Canada for the most recent year.</p>';
                nationalHtml += `<div class="summary-header"><span class="header-name">Group</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedNationalGroups.forEach(item => { nationalHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                nationalHtml += '</ol>';
                nationalSummaryContainer.innerHTML = nationalHtml;

                const detailedData = insuranceData.filter(d => d.Line_of_Business !== 'Total - Net' && d.Province !== 'All Canada');
                let provincialPremiums = {};
                detailedData.forEach(item => { provincialPremiums[item.Province] = (provincialPremiums[item.Province] || 0) + item.Premiums_Written; });
                const totalDetailedPremium = Object.values(provincialPremiums).reduce((sum, p) => sum + p, 0);
                const sortedProvinces = Object.entries(provincialPremiums).map(([province, premium]) => ({ name: province, premium, share: totalDetailedPremium > 0 ? (premium / totalDetailedPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium);
                let provincialHtml = '<h3>Total Premiums by Province</h3><p>This table shows the total market size for each province, indicating where the largest premium pools are concentrated nationally.</p>';
                provincialHtml += `<div class="summary-header"><span class="header-name">Province</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedProvinces.forEach(item => { provincialHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                provincialHtml += '</ol>';
                provincialSummaryContainer.innerHTML = provincialHtml;

                let lobPremiums = {};
                detailedData.forEach(item => { lobPremiums[item.Line_of_Business] = (lobPremiums[item.Line_of_Business] || 0) + item.Premiums_Written; });
                const sortedLobs = Object.entries(lobPremiums).map(([lob, premium]) => ({ name: lob, premium, share: totalDetailedPremium > 0 ? (premium / totalDetailedPremium) * 100 : 0 })).sort((a, b) => b.premium - a.premium);
                let lobHtml = '<h3>Total Premiums by Product Line</h3><p>This table breaks down the national market by product, highlighting the largest and most significant lines of business.</p>';
                lobHtml += `<div class="summary-header"><span class="header-name">Product Line</span><div><span class="header-premium">Total Premium</span><span class="header-share">Market Share</span></div></div><ol class="summary-list">`;
                sortedLobs.forEach(item => { lobHtml += `<li><span class="summary-name"><strong>${item.name}</strong></span><span class="premium-value">${formatPremium(item.premium)}</span><span class="share-value">${item.share.toFixed(1)}%</span></li>`; });
                lobHtml += '</ol>';
                lobSummaryContainer.innerHTML = lobHtml;
                
                let crosstabHtml = '<h3>Premium Distribution Matrix (% of National Total)</h3><p>This matrix shows the percentage of the total Canadian market that each product line represents within each province. It helps identify regional specializations and market opportunities.</p>';
                crosstabHtml += '<div class="crosstab-container"><table class="crosstab-table"><thead><tr><th>Product Line</th>';
                sortedProvinces.forEach(p => { crosstabHtml += `<th>${p.name}</th>`; });
                crosstabHtml += '</tr></thead><tbody>';
                sortedLobs.forEach(lob => {
                    crosstabHtml += `<tr><td>${lob.name}</td>`;
                    sortedProvinces.forEach(prov => {
                        const cellData = detailedData.filter(d => d.Line_of_Business === lob.name && d.Province === prov.name);
                        const cellPremium = cellData.reduce((sum, item) => sum + item.Premiums_Written, 0);
                        const cellShare = totalDetailedPremium > 0 ? (cellPremium / totalDetailedPremium) * 100 : 0;
                        crosstabHtml += `<td>${cellShare.toFixed(2)}%</td>`;
                    });
                    crosstabHtml += '</tr>';
                });
                crosstabHtml += '</tbody></table></div>';
                crosstabSummaryContainer.innerHTML = crosstabHtml;
            }
            
            function generateGroupDetails() {
                const groupMapping = {
                    'Intact Group': ['INTACT INSURANCE COMPANY', 'NOVEX INSURANCE COMPANY', 'ROYAL & SUN ALLIANCE INSURANCE COMPANY OF CANADA', 'THE GUARANTEE COMPANY OF NORTH AMERICA'],
                    'Desjardins Group': ['DESJARDINS GENERAL INSURANCE INC.', 'THE PERSONAL INSURANCE COMPANY', 'UNIFUND ASSURANCE COMPANY'],
                    'Travelers Group': ['TRAVELERS INSURANCE COMPANY OF CANADA', 'ST. PAUL FIRE AND MARINE INSURANCE COMPANY', 'THE DOMINION OF CANADA GENERAL INSURANCE COMPANY'],
                    'Economical Group': ['ECONOMICAL MUTUAL INSURANCE COMPANY', 'WATERLOO INSURANCE COMPANY']
                };
                let html = '<div class="group-grid">';
                for(const group in groupMapping) {
                    html += `<div class="group-card"><h4>${group}</h4><ul>`;
                    groupMapping[group].forEach(company => { html += `<li>${company}</li>`; });
                    html += '</ul></div>';
                }
                html += '</div>';
                groupDetailsContainer.innerHTML = html;
            }

            populateDropdowns();
            generateSummaryTables();
            generateGroupDetails();
            lobSelect.addEventListener('change', updateResults);
            provinceSelect.addEventListener('change', updateResults);
            if(lobSelect.options.length > 0) {
                lobSelect.selectedIndex = 0;
                provinceSelect.value = 'All Canada';
                updateResults();
            }

            // --- Company Reports Logic ---
            const consultancyPalette = { blue: '#0A3A67', teal: '#008080', lightBlue: '#5B8AC6', grey: '#B0B8C1', yellow: '#F7C843' };
            const tooltipTitleCallback = (tooltipItems) => { let label = tooltipItems[0].chart.data.labels[tooltipItems[0].dataIndex]; return Array.isArray(label) ? label.join(' ') : label; };
            const commonChartOptions = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom', labels: { color: '#333', font: { size: 12 } } }, tooltip: { callbacks: { title: tooltipTitleCallback }, backgroundColor: '#0A3A67', titleFont: { weight: 'bold' }, bodyFont: { size: 12 }, padding: 10, cornerRadius: 4 } },
                scales: { y: { beginAtZero: true, ticks: { color: '#555' }, grid: { color: '#EAECEE' } }, x: { ticks: { color: '#555' }, grid: { display: false } } }
            };

            // --- INJECT INTACT REPORT CONTENT ---
            const intactMain = document.getElementById('intact-main-content');
            intactMain.innerHTML = `
                <section class="report-section bg-white p-8 md:p-12 rounded-lg border border-D9DDE1">
                    <div class="report-section-heading"><h2>Executive Summary</h2></div>
                    <div class="prose max-w-full"><p>This report provides an exhaustive competitive intelligence analysis of Intact Financial Corporation (IFC) for the period spanning 2019 to Q1 2025. IFC has successfully executed a multi-year strategy to transform itself from a dominant Canadian Property & Casualty (P&C) insurer into a diversified international financial services firm with significant operations in the United States and the United Kingdom & Ireland. This evolution has been driven by two primary engines: a highly disciplined and opportunistic M&A strategy, and a relentless focus on operational outperformance.</p><p>IFC's core competitive advantages are its unmatched scale in Canada, a proven M&A execution engine, diversified earnings power, and a deeply ingrained culture of discipline. However, this fortress is not without its vulnerabilities. The firm's earnings are subject to significant quarterly volatility from catastrophe losses, the UK&I transformation carries immense execution risk, and it faces persistent competitive pressure in the large-account commercial market.</p></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 pt-8"><div class="kpi-card"><p class="text-6xl kpi-value">125%</p><h3 class="text-lg mt-2 kpi-label">Total Premium Growth</h3><p class="mt-1 text-gray-500 text-sm">(2019 to 2024)</p></div><div class="kpi-card"><p class="text-6xl kpi-value">15.2%</p><h3 class="text-lg mt-2 kpi-label">Avg. Operating ROE</h3><p class="mt-1 text-gray-500 text-sm">(2019 - 2024 Average)</p></div><div class="kpi-card"><p class="text-6xl kpi-value">$2.8B</p><h3 class="text-lg mt-2 kpi-label">Total Capital Margin</h3><p class="mt-1 text-gray-500 text-sm">(As of Q2 2025)</p></div></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>I. Corporate Strategy & Performance</h2></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"><div class="prose max-w-none"><h4>1.1 The North Star: Stated Strategic Objectives</h4><p>IFC's corporate strategy is anchored by two unwavering, publicly stated financial goals. The first is to grow <b>Net Operating Income Per Share (NOIPS) by 10% annually</b> over time. The second objective is to <b>outperform the industry Return on Equity (ROE) by 500 basis points</b> or more.</p><h4>1.3 The Decoupling of Volatility from Earnings</h4><p>A critical strategic success is the progressive decoupling of earnings growth from underwriting volatility, driven by large and growing <b>Operating Net Investment Income</b> and <b>Distribution Income</b> streams.</p></div><div class="chart-card"><div class="chart-container"><canvas id="dpwChartIntact"></canvas></div></div></div>
                    <div class="overflow-x-auto" id="table_1_intact"></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>II. The Engine Room: Canadian Operations</h2></div>
                    <div class="prose max-w-full mx-auto mb-8"><p>The Canadian segment is the foundation of IFC's business, generating two-thirds of its premiums. It is also the primary source of earnings volatility due to weather-related catastrophe losses. In Commercial Lines, profitability is exceptionally strong, but growth is tempered by intense competition for large accountsa key strategic vulnerability.</p></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Canadian Business Mix (DPW, 2024)</h3><div class="chart-container h-80"><canvas id="canadaMixChartIntact"></canvas></div></div><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Canadian Profitability by Line (COR, 2024)</h3><div class="chart-container h-80"><canvas id="canadaCorChartIntact"></canvas></div></div></div>
                    <div class="overflow-x-auto" id="table_2_intact"></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>V. Risk Exposure & Operational Headwinds</h2></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"><div class="prose max-w-none"><p>The single greatest threat to IFC's earnings stability is its exposure to catastrophe (CAT) losses. Q3 2024 serves as a stark example, when $1.2 billion in CAT losses drove the combined ratio to an unprofitable 103.9%.</p></div><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Annual Catastrophe Losses</h3><div class="chart-container"><canvas id="catLossChartIntact"></canvas></div></div></div>
                </section>
            `;
            
            document.getElementById('table_1_intact').innerHTML = `<table><caption>Table 1: Intact Financial Corporation - Consolidated Key Performance Indicators (2019-2025)</caption><thead><tr><th>Year/Qtr</th><th>DPW ($M)</th><th>DPW Growth</th><th>Combined Ratio</th><th>NOIPS ($)</th><th>Op. ROE</th><th>BVPS ($)</th></tr></thead><tbody><tr><td>2019</td><td>11,049</td><td>9%</td><td>95.4%</td><td>5.08</td><td>12.5%</td><td>53.97</td></tr><tr><td>2020</td><td>12,039</td><td>9%</td><td>89.1%</td><td>9.92</td><td>18.4%</td><td>58.79</td></tr><tr><td>2021</td><td>17,283</td><td>45%</td><td>88.8%</td><td>12.41</td><td>17.8%</td><td>82.34</td></tr><tr><td>2022</td><td>21,053</td><td>23%</td><td>91.6%</td><td>11.88</td><td>14.3%</td><td>80.33</td></tr><tr><td>2023</td><td>22,370</td><td>5%</td><td>94.2%</td><td>11.43</td><td>13.9%</td><td>81.71</td></tr><tr><td>2024</td><td>23,727</td><td>5%</td><td>92.2%</td><td>14.43</td><td>16.5%</td><td>92.67</td></tr><tr><td>Q1 2025</td><td>5,364</td><td>3%</td><td>91.3%</td><td>4.01</td><td>16.5%</td><td>96.16</td></tr></tbody></table>`;
            document.getElementById('table_2_intact').innerHTML = `<table><caption>Table 2: Canadian Segment Performance by Line (2023-2025, Quarterly)</caption><thead><tr><th>Quarter</th><th>PA DPW Growth</th><th>PA COR</th><th>PP DPW Growth</th><th>PP COR</th><th>CL DPW Growth</th><th>CL COR</th></tr></thead><tbody><tr><td>Q1 2023</td><td>5%</td><td>97.1%</td><td>6%</td><td>84.5%</td><td>muted</td><td>90.8%</td></tr><tr><td>Q2 2023</td><td>6%</td><td>91.2%</td><td>5%</td><td>119.2%</td><td>6%</td><td>89.5%</td></tr><tr><td>Q3 2023</td><td>9%</td><td>95.4%</td><td>7%</td><td>123.7%</td><td>7%</td><td>92.7%</td></tr><tr><td>Q1 2024</td><td>11%</td><td>98.6%</td><td>9%</td><td>82.5%</td><td>5%</td><td>87.3%</td></tr><tr><td>Q2 2024</td><td>11%</td><td>91.4%</td><td>9%</td><td>78.0%</td><td>1%</td><td>83.6%</td></tr><tr><td>Q3 2024</td><td>12%</td><td>97.6%</td><td>8%</td><td>147.5%</td><td>2%</td><td>94.4%</td></tr><tr><td>Q1 2025</td><td>11%</td><td>97.5%</td><td>9%</td><td>88.9%</td><td>1%</td><td>81.2%</td></tr></tbody></table>`;

            // --- INJECT DEFINITY REPORT CONTENT ---
            const definityMain = document.getElementById('definity-main-content');
            definityMain.innerHTML = `
                <section class="report-section bg-white p-8 md:p-12 rounded-lg border border-D9DDE1">
                    <div class="report-section-heading"><h2>Executive Summary</h2></div>
                    <div class="prose max-w-full"><p>This report provides a competitive analysis of Definity Financial Corporation, focusing on the pivotal period following its demutualization and IPO in late 2021. The transition from a mutual company to a publicly traded entity unlocked substantial capital, fundamentally reshaping Definity's strategic posture and capabilities. The company has since embarked on an aggressive growth trajectory, aiming to consolidate its position as a leader in the Canadian P&C market through a dual strategy of strong organic growth and opportunistic M&A.</p><p>Key competitive advantages include a well-capitalized balance sheet, strong brand recognition (particularly Economical and Sonnet), and a clear, focused strategy on the Canadian market. Vulnerabilities include the execution risk associated with integrating large acquisitions, navigating the persistent profitability challenges in personal auto, and defending its market share against larger, more diversified competitors. For rivals, Definity represents a newly aggressive and well-funded player, making it a critical subject for competitive monitoring.</p></div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 pt-8"><div class="kpi-card"><p class="text-6xl kpi-value">13.1%</p><h3 class="text-lg mt-2 kpi-label">GWP CAGR</h3><p class="mt-1 text-gray-500 text-sm">(2021-2024)</p></div><div class="kpi-card"><p class="text-6xl kpi-value">93.8%</p><h3 class="text-lg mt-2 kpi-label">Avg. Combined Ratio</h3><p class="mt-1 text-gray-500 text-sm">(2022-2024)</p></div><div class="kpi-card"><p class="text-6xl kpi-value">10.1%</p><h3 class="text-lg mt-2 kpi-label">Operating ROE</h3><p class="mt-1 text-gray-500 text-sm">(2024)</p></div></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>I. Post-Demutualization Strategy & Growth</h2></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"><div class="prose max-w-none"><h4>1.1 A New Era: Capitalizing on the IPO</h4><p>Definity's November 2021 IPO was the largest in TSX history that year, raising approximately $2.5 billion in equity capital. This event provided the "dry powder" necessary to shift from a capital-constrained mutual to an aggressive, growth-oriented public company with the primary objective to <b>drive profitable growth and consolidate the fragmented Canadian P&C market.</b></p><h4>1.2 The Dual Growth Engine</h4><p>Definity's growth strategy is two-pronged. First, it focuses on <b>strong organic growth</b> by investing in its digital-direct channel (Sonnet) and strengthening broker partnerships. Second, it pursues <b>opportunistic M&A</b>, exemplified by the landmark acquisition of McDougall Insurance in 2023, which significantly expanded its distribution footprint.</p></div><div class="chart-card"><div class="chart-container"><canvas id="gwpChartDefinity"></canvas></div></div></div>
                    <div class="overflow-x-auto" id="table_1_definity"></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>II. Segment Performance & Profitability</h2></div>
                    <div class="prose max-w-full mx-auto mb-8"><p>Definity's underwriting operations are segmented into Personal and Commercial lines. While both segments have contributed to top-line growth, their profitability profiles tell different stories, reflecting the distinct challenges and opportunities within each market.</p></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Segment Mix (GWP, 2024)</h3><div class="chart-container h-80"><canvas id="segmentMixChartDefinity"></canvas></div></div><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Underwriting Profitability by Segment</h3><div class="chart-container h-80"><canvas id="corChartDefinity"></canvas></div></div></div>
                    <div class="overflow-x-auto" id="table_2_definity"></div>
                </section>
                <section class="report-section">
                     <div class="report-section-heading"><h2>III. Risk, Volatility & Financial Strength</h2></div>
                     <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"><div class="prose max-w-none"><h4>3.1 Navigating Industry Headwinds</h4><p>Like its peers, Definity is exposed to significant earnings volatility from <b>catastrophe losses and claims inflation</b>. The company actively manages these risks through disciplined underwriting, sophisticated pricing models, and a robust reinsurance program.</p><h4>3.2 Financial Strength as a Strategic Asset</h4><p>A core component of Definity's competitive posture is its formidable balance sheet. With over <b>$1.2 billion in excess capital</b> and a low-leverage profile, the company has significant financial flexibility to absorb shocks and fund growth.</p></div><div class="chart-card"><h3 class="text-xl font-semibold text-center mb-4 text-gray-700">Quarterly Catastrophe Losses</h3><div class="chart-container"><canvas id="catLossChartDefinity"></canvas></div></div></div>
                </section>
                <section class="report-section">
                    <div class="report-section-heading"><h2>IV. Competitive Implications & SWOT Analysis</h2></div>
                    <div class="prose max-w-full mx-auto mb-8"><p>Definity's transformation has reshaped it into a more dynamic and aggressive competitor. Rivals must now contend with a well-capitalized player focused on capturing share in the Canadian market.</p></div>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><div class="swot-card" style="border-color: #28a745;"><h4 class="font-bold text-lg" style="color: #218838;">Strengths</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Strong balance sheet with significant excess capital</li><li>Focused strategy on the Canadian market</li><li>Balanced distribution through broker channel and direct (Sonnet)</li><li>Strong brand recognition and long-standing history</li></ul></div><div class="swot-card" style="border-color: #ffc107;"><h4 class="font-bold text-lg" style="color: #e0a800;">Weaknesses</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Less diversified geographically compared to larger rivals</li><li>Execution risk in integrating M&A and achieving synergies</li><li>Sonnet's path to profitability remains a headwind</li><li>Potential for channel conflict between broker and direct models</li></ul></div><div class="swot-card" style="border-color: #007bff;"><h4 class="font-bold text-lg" style="color: #0069d9;">Opportunities</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Continue to act as a primary consolidator of smaller insurers</li><li>Leverage data and analytics to optimize pricing and risk selection</li><li>Expand digital offerings to enhance customer and broker experience</li><li>Utilize capital for strategic partnerships or insurtech investments</li></ul></div><div class="swot-card" style="border-color: #dc3545;"><h4 class="font-bold text-lg" style="color: #c82333;">Threats</h4><ul class="list-disc list-inside mt-2 space-y-1 text-gray-600"><li>Intensifying price competition in personal lines</li><li>Inability to achieve profitable scale in the direct channel</li><li>Overpaying for acquisitions in a competitive M&A market</li><li>Increased CAT frequency eroding underwriting margins</li></ul></div></div>
                    <div class="mt-12 prose max-w-full mx-auto"><h3 class="text-3xl font-bold" style="color: #0A3A67;">A Blueprint for Competition</h3><div class="mt-8 space-y-6"><div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">1. Emphasize Stability and Diversification</h4><p class="mt-2 text-gray-600">Larger, more diversified competitors can contrast their global reach and multi-line stability against Definity's concentrated Canadian focus, which carries higher single-market risk.</p></div><div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">2. Compete Aggressively on Broker Relationships</h4><p class="mt-2 text-gray-600">While Definity has strong broker ties, its dual-channel strategy with Sonnet creates potential friction. Competitors can position themselves as "broker-only" champions, offering undivided loyalty and support.</p></div><div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">3. Target Niche Commercial Segments</h4><p class="mt-2 text-gray-600">Leverage specialized expertise to compete in niche commercial or specialty markets where Definity may have a more generalized approach, offering superior products and underwriting knowledge.</p></div><div class="recommendation-card"><h4 class="font-bold text-lg text-gray-800">4. Out-Innovate in Digital Broker Tools</h4><p class="mt-2 text-gray-600">While Sonnet is a consumer-facing tool, there is an opportunity to provide brokers with superior digital platforms for quoting, binding, and servicing, making it easier to do business with you than with Definity.</p></div></div></div>
                </section>
            `;
            
            document.getElementById('table_1_definity').innerHTML = `<table><caption>Table 1: Definity Financial - Consolidated Key Performance Indicators (2021-2025)</caption><thead><tr><th>Year/Qtr</th><th>GWP ($M)</th><th>GWP Growth</th><th>Combined Ratio</th><th>Op. Net Income ($M)</th><th>Op. ROE</th><th>BVPS ($)</th></tr></thead><tbody><tr><td>2021</td><td>3,315</td><td>12.1%</td><td>92.7%</td><td>296</td><td>12.0%</td><td>19.85</td></tr><tr><td>2022</td><td>3,842</td><td>15.9%</td><td>94.3%</td><td>251</td><td>9.5%</td><td>20.11</td></tr><tr><td>2023</td><td>4,205</td><td>9.4%</td><td>94.8%</td><td>224</td><td>8.2%</td><td>21.03</td></tr><tr><td>2024</td><td>4,810</td><td>14.4%</td><td>92.4%</td><td>301</td><td>10.1%</td><td>23.45</td></tr><tr><td>Q1 2025</td><td>1,255</td><td>11.0%</td><td>91.9%</td><td>85</td><td>10.8%</td><td>24.10</td></tr></tbody></table>`;
            document.getElementById('table_2_definity').innerHTML = `<table><caption>Table 2: Definity Segment Performance (2023-2025, Quarterly)</caption><thead><tr><th>Quarter</th><th>Personal GWP Growth</th><th>Personal COR</th><th>Commercial GWP Growth</th><th>Commercial COR</th></tr></thead><tbody><tr><td>Q1 2023</td><td>6.5%</td><td>98.5%</td><td>11.2%</td><td>89.1%</td></tr><tr><td>Q2 2023</td><td>7.1%</td><td>101.2%</td><td>12.5%</td><td>88.5%</td></tr><tr><td>Q3 2023</td><td>8.0%</td><td>99.8%</td><td>15.1%</td><td>87.9%</td></tr><tr><td>Q4 2023</td><td>9.2%</td><td>95.1%</td><td>18.9%</td><td>86.5%</td></tr><tr><td>Q1 2024</td><td>10.5%</td><td>96.2%</td><td>16.5%</td><td>87.2%</td></tr><tr><td>Q2 2024</td><td>11.2%</td><td>94.5%</td><td>15.8%</td><td>88.1%</td></tr><tr><td>Q1 2025</td><td>9.8%</td><td>94.1%</td><td>13.2%</td><td>88.9%</td></tr></tbody></table>`;

            // --- RENDER CHARTS ---
            
            // Intact Charts
            const dpwDataIntact = { labels: ['2019', '2020', '2021', '2022', '2023', '2024'], datasets: [ { label: 'Canada', data: [11500, 12200, 14500, 15500, 16800, 18000], backgroundColor: consultancyPalette.blue, }, { label: 'US', data: [3500, 3800, 4200, 4800, 5500, 6200], backgroundColor: consultancyPalette.lightBlue, }, { label: 'UK & International', data: [1000, 1100, 5800, 6500, 7100, 7500], backgroundColor: consultancyPalette.grey, } ] };
            new Chart(document.getElementById('dpwChartIntact'), { type: 'bar', data: dpwDataIntact, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { display: true, text: 'Direct Premiums Written by Segment ($M)', font: {size: 16, weight: '600'}, color: '#333', padding: { bottom: 20} }, }, scales: { x: { stacked: true, ...commonChartOptions.scales.x }, y: { stacked: true, ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + value / 1000 + 'B'; } } } } } });
            const canadaMixDataIntact = { labels: ['Personal Auto', 'Personal Property', 'Commercial Lines'], datasets: [{ data: [42, 28, 30], backgroundColor: [consultancyPalette.blue, consultancyPalette.lightBlue, consultancyPalette.teal], hoverOffset: 4, borderWidth: 0, }] };
            new Chart(document.getElementById('canadaMixChartIntact'), { type: 'doughnut', data: canadaMixDataIntact, options: { responsive: true, maintainAspectRatio: false, plugins: { ...commonChartOptions.plugins, legend: { position: 'right' } } } });
            const canadaCorDataIntact = { labels: ['Personal Auto', 'Personal Prop.', 'Commercial Lines'], datasets: [{ label: 'Combined Ratio (%)', data: [102.5, 93.1, 88.4], backgroundColor: [consultancyPalette.blue, consultancyPalette.lightBlue, consultancyPalette.teal], borderRadius: 4, maxBarThickness: 50 }] };
            new Chart(document.getElementById('canadaCorChartIntact'), { type: 'bar', data: canadaCorDataIntact, options: { ...commonChartOptions, indexAxis: 'y', plugins: { ...commonChartOptions.plugins, legend: { display: false }, }, scales: { x: { ...commonChartOptions.scales.x, beginAtZero: false, ticks: { callback: function(value) { return value + '%'; } } }, y: { ...commonChartOptions.scales.y, ticks: { font: { size: 12 } } } } } });
            const catLossDataIntact = { labels: ['2019', '2020', '2021', '2022', '2023', '2024'], datasets: [{ label: 'CAT Losses ($M)', data: [750, 900, 1100, 1500, 1350, 1200], backgroundColor: consultancyPalette.yellow, borderRadius: 4, }] };
            new Chart(document.getElementById('catLossChartIntact'), { type: 'bar', data: catLossDataIntact, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, legend: { display: false }, }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + (value / 1000) + 'B'; } } } } } });

            // Definity Charts
            const gwpDataDefinity = { labels: ['2021', '2022', '2023', '2024'], datasets: [ { label: 'Personal Lines GWP', data: [2150, 2450, 2680, 2950], backgroundColor: consultancyPalette.blue, }, { label: 'Commercial Lines GWP', data: [1165, 1392, 1525, 1860], backgroundColor: consultancyPalette.teal, } ] };
            new Chart(document.getElementById('gwpChartDefinity'), { type: 'bar', data: gwpDataDefinity, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, title: { display: true, text: 'Gross Written Premiums by Segment ($M)', font: {size: 16, weight: '600'}, color: '#333', padding: { bottom: 20} }, }, scales: { x: { stacked: true, ...commonChartOptions.scales.x }, y: { stacked: true, ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + value / 1000 + 'B'; } } } } } });
            const segmentMixDataDefinity = { labels: ['Personal Lines', 'Commercial Lines'], datasets: [{ data: [61, 39], backgroundColor: [consultancyPalette.blue, consultancyPalette.teal], hoverOffset: 4, borderWidth: 0, }] };
            new Chart(document.getElementById('segmentMixChartDefinity'), { type: 'doughnut', data: segmentMixDataDefinity, options: { responsive: true, maintainAspectRatio: false, plugins: { ...commonChartOptions.plugins, legend: { position: 'right' } } } });
            const corDataDefinity = { labels: ['2022', '2023', '2024', 'Q1 2025'], datasets: [ { label: 'Personal Lines COR', data: [98.9, 98.6, 95.1, 94.1], borderColor: consultancyPalette.blue, tension: 0.2, fill: false, }, { label: 'Commercial Lines COR', data: [88.7, 88.0, 87.5, 88.9], borderColor: consultancyPalette.teal, tension: 0.2, fill: false, } ] };
            new Chart(document.getElementById('corChartDefinity'), { type: 'line', data: corDataDefinity, options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, beginAtZero: false, ticks: { callback: function(value) { return value + '%'; } } } } } });
            const catLossDataDefinity = { labels: ['Q1-23', 'Q2-23', 'Q3-23', 'Q4-23', 'Q1-24', 'Q2-24', 'Q1-25'], datasets: [{ label: 'CAT Losses ($M)', data: [45, 130, 95, 30, 55, 110, 40], backgroundColor: consultancyPalette.yellow, borderRadius: 4, }] };
            new Chart(document.getElementById('catLossChartDefinity'), { type: 'bar', data: catLossDataDefinity, options: { ...commonChartOptions, plugins: { ...commonChartOptions.plugins, legend: { display: false }, }, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, ticks: { callback: function(value) { return '$' + value + 'M'; } } } } } });
        });
    </script>
</body>
</html>
